---
author: bydiao
comments: true
date: 2014-01-16
layout: post
title: 全面迁移Gibhub
categories: [技术杂汇]
tags:
- github
- jekyll
---

香港买的服务器即将续费，看到身边的朋友在Gibhub搭起了个人网站，享受很多免费服务，且网站逻辑清晰，见解，相对也比较灵活，Geek范十足。于是毫不犹豫的加入Github大家庭。

从服务器迁移到Github思路非常清晰，网上也有很多资料，现总结一下自己的流程。

* 在Github上建站
    Github提供了免费的子域名，username.github.io，但这只是建站用的，你可以把自己的顶级域名绑定到这个子域名上，这是最吸引人的地方，建站服务很多平台都支持，包括Azure等，但绑定顶级域名都是付费服务。
建站的过程很简单，只要你建立一个username.github.io项目，在其中建立符合jekyll架构的目录结构，同步到github上。即可通过 username.github.io的域名访问网站。绑定顶级域名，只需将域名写入文件，命名为CNAME，放到根目录下，再去dns服务平台进行设置即可。
最终的目录结构如下，其中
    1. _layouts放置模板库
    2. _posts放置所有博客内容
    3. index.html是主页
    4. _config.yml是配置文件，配置markdown解析器等很多参数
    5. CNAME存入要绑定的顶级域名
其他的都不是必须的
    ![](http://pic.yupoo.com/bitcsdby/DsU7q0Cs/medish.jpg)

* 建博客站，建站可以去参考大牛已经弄好的default和post模板等。可参考此处 
[https://github.com/jekyll/jekyll/wiki/Sites](https://github.com/jekyll/jekyll/wiki/Sites)
建立好各个html的框架和逻辑关系，模板等，这部分需要有点网页知识，尤其要简单学习一下liquid语言
[https://github.com/Shopify/liquid/wiki/Liquid-for-Designers](https://github.com/Shopify/liquid/wiki/Liquid-for-Designers)
主要是了解模板参数怎么用，如何自定义参数，post加载的逻辑，diy网站接口在哪里等，这里有诸多细节，不一一列举了，在下面置顶功能中会提到一些，jekyll的官网文档也很有用
[http://jekyllrb.com/docs/home/](http://jekyllrb.com/docs/home/)

* 博客站建成后，写完一篇post，可以通过很多方式发布
    1. 用markdownpad等编辑后，拖到_posts下，再本地同步
    2. 通过stackedit在线编辑发布

    最终博客都会到github上的_posts文件夹下，即可访问。
    可能会遇到一系列问题，总结如下：
    1. 博客网页404，可能是categories或tags下有一些特殊字符，貌似要不合c语言变量定义规则。
    2. 博客网页乱码，可能是front-matter部分有非法字符，例如冒号要用英文冒号，且要随后一定要有一个空格
    {% highlight html %}
    ---
    layout: post
    title: abc
    ---
    {% endhighlight %}
* 下面是写博客中遇到的一些问题，第一点就是如何让jekyll支持公式解析，这里要借助Mathjax来渲染，jekyll本身是不支持公式解析的，需要在post模板中加入以下两段代码，第一段是支持用双美元符夹一个latex语句来做行间公式，第二段是用单美元符夹一个latex语句来做行内公式，同时还要用kramdown作为markdown的解析器，实践中发现kramdown也会有一些问题，不过比其他解析器对公式的支持好很多。

{% highlight javascript %}
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] }
    });
</script>
{% endhighlight %}

* 另一个问题是实现代码语法高亮，jekyll自身默认提供代码高亮，enter+tab键即可输入代码，但想要有语法高亮，还要借助pygments，在_config.yml配置
{% highlight javascript %}
pygments: true
{% endhighlight %}
即可

* 博客分类，github的博客模板中有很多支持博客分类，觉得这是博客不可缺少的功能之一，可以通过front-matter预定义的categories和tags来实现。具体代码可以去我github上看，是基于一个大牛博客改编的。[github.com/bitcsdby](github.com/bitcsdby)，其实jekyll已经帮你做好了，你只要了解jekyll做了哪些，再活用它做好的数据结构显示出来即可。

* 博客置顶，也是一个重要功能，这个貌似没有现成的，经过几番折腾，对liquid和jekyll都有了了解，置顶的思路也出来了，即自定义一个变量 istop 放到front-matter中，加载博客的时候，先扫一遍博客，加载istop为true的，再扫一遍博客，加载没定义istop或者istop为false的post，这样就把置顶博客筛出来了。写的时候，把要置顶的博客如下设置
{% highlight html %}
    ---
    layout: post
    title: abc
    istop: true
    ---
    {% endhighlight %}
即可。具体代码也可去我的github上看。


以上按我折腾github+jekyll的顺序做了一些总结，博客站也建起来了，想要实现的功能也实现了，正式安家github，顶级域名 diaoboyu.cn不变，择日再把host放上去。